---
title: "checking files"
author: "Kimberly Olney, Ph.D"
date: "07/13/2022"
output:
  html_document:
    theme: cerulean
    toc: true
    toc_float: true
editor_options: 
  chunk_output_type: inline
---

# Setup
```{r setup}
# Also do Session > Set Working Directory > Choose Directory
knitr::opts_knit$set(root.dir = ".")
```


# User defined variables
```{r set_variables}
control <- "CONTROL"
condition <- "LBD"
control_color <- "gray29"
condition_color <- "red"
myContrasts <- c("LBD - CONTROL")
tool = c("star")
pathToRef = c("/research/labs/neurology/fryer/projects/references/human/")
pathToRawData = c("/research/labs/neurology/fryer/projects/LBD_CWOW/")
```

# Read data
```{r read_data}
# read in metadata
metadata <- read.delim(paste0(pathToRawData, "metadata.tsv"), 
                       header = TRUE,
                       sep = "\t")

WGS <- read.delim(paste0(pathToRawData, "WGS_sampleID.txt"), 
                       header = TRUE,
                       sep = "\t")

LBD_count <- subset(metadata, TYPE == "LBD")
WGS_metadata <- merge(metadata, WGS, by = "NPID")


test2 <- unique(metadata$NPID)
RIN <- read.delim(paste0(pathToRawData, "RIN.tsv"), 
                       header = TRUE,
                       sep = "\t")
RIN$NPID <- RIN$Sample
metadata <- merge(metadata, RIN, by = "NPID")

WGS_mactch_RNA <- intersect(WGS$NPID, metadata$NPID)
```

```{r}
snakemake_sample_info <- read.delim("../snakemake/sample_read_group_info.txt", header = FALSE)
# get the sampleID from the counts file to match with metadata
snakemake_sample_info[c('NPID', 'flowcell')] <- str_split_fixed(snakemake_sample_info$V1, '.FC', 2)

snake_metadata <- merge(metadata, snakemake_sample_info, by = "NPID")
hello <- smartbind(metadata, snakemake_sample_info) #, by = "NPID")
test <- unique(snake_metadata$NPID, )
hello <- subset(snake_metadata, unique(snake_metadata$NPID), )
df <-  snake_metadata[duplicated(snake_metadata$NPID), ]
write.table(df, "LBD_batch_1-4.txt", quote = FALSE, row.names = FALSE, sep = "\t")
library(gtools)
```
